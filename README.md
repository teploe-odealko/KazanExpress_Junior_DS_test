# KazanExpress product category prediction
## Решение
Задачу можно начать решать в лоб и обучить классификатор на самый нижний уровень категорий, но в таком случае мы потеряем информацию а промежуточных категориях, поэтому стоит подумать о чем-то более сложном.
### pipeline
- **Предобработка названий товаров.** Пока просто удаляются стоп-слова. Добавление нормализации слов должно дать прирост к метрикаим (лемматизация или стемминг).
- **Векторизация.** Используется word2vec, который обучается на текущих данных. Можно попробовать загружать предобученные эмбединги.
- **Обучение модели.** В качестве модели используется обычная полносвязная сеть, которую обучаем в несколько итераций с добавлением слоев.
 
### Обучение модели
Сначала обучаем полносвязную сеть с количеством выходных нейронов равному количесву категорий на высшем уровне (в нашем случае 3).  
![alt text](https://github.com/teploe-odealko/KazanExpress_Junior_DS_test/blob/b56d186abec33217283adc6934f10981434ebdce/imgs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202021-09-14%20%D0%B2%2019.56.21.png?raw=true).   
После сохраним веса и добавим к сети еще несколько слоев, так, чтобы теперь на выходе было 37 нейронов (как на втором уровне категорий). И мы надеемся на то, что наша сеть, обладая информацией с предыдущего уровня, будет лучше разделять объекты.
![alt text](https://github.com/teploe-odealko/KazanExpress_Junior_DS_test/blob/b56d186abec33217283adc6934f10981434ebdce/imgs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202021-09-14%20%D0%B2%2019.58.23.png?raw=true).   
Продолжаем так до самого нижнего уровня из иерархии категорий.  
![alt text](https://github.com/teploe-odealko/KazanExpress_Junior_DS_test/blob/b56d186abec33217283adc6934f10981434ebdce/imgs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202021-09-14%20%D0%B2%2020.01.52.png?raw=true).   
